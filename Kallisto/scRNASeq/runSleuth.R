library('sleuth')

base_dir <- './'

samples <- c("Kal_SRR2013442",
"Kal_SRR2013443",
"Kal_SRR2013444",
"Kal_SRR2013445",
"Kal_SRR2013446",
"Kal_SRR2013447",
"Kal_SRR2013448",
"Kal_SRR2013449",
"Kal_SRR2013450",
"Kal_SRR2013451",
"Kal_SRR2013452",
"Kal_SRR2013453",
"Kal_SRR2013454",
"Kal_SRR2013455",
"Kal_SRR2013456",
"Kal_SRR2013457",
"Kal_SRR2013458",
"Kal_SRR2013459",
"Kal_SRR2013460",
"Kal_SRR2013461",
"Kal_SRR2013462",
"Kal_SRR2013463",
"Kal_SRR2013464",
"Kal_SRR2013465",
"Kal_SRR2013466",
"Kal_SRR2013467",
"Kal_SRR2013468",
"Kal_SRR2013469",
"Kal_SRR2013470",
"Kal_SRR2013471",
"Kal_SRR2013472",
"Kal_SRR2013473",
"Kal_SRR2013474",
"Kal_SRR2013475",
"Kal_SRR2013476",
"Kal_SRR2013477",
"Kal_SRR2013478",
"Kal_SRR2013479",
"Kal_SRR2013480",
"Kal_SRR2013481",
"Kal_SRR2013482",
"Kal_SRR2013483",
"Kal_SRR2013484",
"Kal_SRR2013485",
"Kal_SRR2013486",
"Kal_SRR2013487",
"Kal_SRR2013488",
"Kal_SRR2013489",
"Kal_SRR2013490",
"Kal_SRR2013491",
"Kal_SRR2013492",
"Kal_SRR2013493",
"Kal_SRR2013494",
"Kal_SRR2013495",
"Kal_SRR2013496",
"Kal_SRR2013497",
"Kal_SRR2013498",
"Kal_SRR2013499",
"Kal_SRR2013500",
"Kal_SRR2013501",
"Kal_SRR2013502",
"Kal_SRR2013503",
"Kal_SRR2013504",
"Kal_SRR2013505",
"Kal_SRR2013506",
"Kal_SRR2013507",
"Kal_SRR2013508",
"Kal_SRR2013509",
"Kal_SRR2013510",
"Kal_SRR2013511",
"Kal_SRR2013512",
"Kal_SRR2013513",
"Kal_SRR2013514",
"Kal_SRR2013515",
"Kal_SRR2013516",
"Kal_SRR2013517",
"Kal_SRR2013518",
"Kal_SRR2013519",
"Kal_SRR2013520",
"Kal_SRR2013521",
"Kal_SRR2013522",
"Kal_SRR2013523",
"Kal_SRR2013524",
"Kal_SRR2013525",
"Kal_SRR2013526",
"Kal_SRR2013527",
"Kal_SRR2013528",
"Kal_SRR2013529",
"Kal_SRR2013530",
"Kal_SRR2013531",
"Kal_SRR2013532",
"Kal_SRR2013533",
"Kal_SRR2013534",
"Kal_SRR2013535",
"Kal_SRR2013536",
"Kal_SRR2013537",
"Kal_SRR2013538",
"Kal_SRR2013539",
"Kal_SRR2013540",
"Kal_SRR2013541",
"Kal_SRR2013542",
"Kal_SRR2013543",
"Kal_SRR2013544",
"Kal_SRR2013545",
"Kal_SRR2013546",
"Kal_SRR2013547",
"Kal_SRR2013548",
"Kal_SRR2013549",
"Kal_SRR2013550",
"Kal_SRR2013551",
"Kal_SRR2013552",
"Kal_SRR2013553",
"Kal_SRR2013554",
"Kal_SRR2013555",
"Kal_SRR2013556",
"Kal_SRR2013557",
"Kal_SRR2013558",
"Kal_SRR2013559",
"Kal_SRR2013560",
"Kal_SRR2013561",
"Kal_SRR2013562",
"Kal_SRR2013563",
"Kal_SRR2013564",
"Kal_SRR2013565",
"Kal_SRR2013566",
"Kal_SRR2013567",
"Kal_SRR2013568",
"Kal_SRR2013569",
"Kal_SRR2013570",
"Kal_SRR2013571",
"Kal_SRR2013572",
"Kal_SRR2013573",
"Kal_SRR2013574",
"Kal_SRR2013575",
"Kal_SRR2013576",
"Kal_SRR2013577",
"Kal_SRR2013578",
"Kal_SRR2013579",
"Kal_SRR2013580",
"Kal_SRR2013581",
"Kal_SRR2013582",
"Kal_SRR2013583",
"Kal_SRR2013584",
"Kal_SRR2013585",
"Kal_SRR2013586",
"Kal_SRR2013587",
"Kal_SRR2013588",
"Kal_SRR2013589",
"Kal_SRR2013590",
"Kal_SRR2013591",
"Kal_SRR2013592",
"Kal_SRR2013593",
"Kal_SRR2013594",
"Kal_SRR2013595",
"Kal_SRR2013596",
"Kal_SRR2013597",
"Kal_SRR2013598",
"Kal_SRR2013599",
"Kal_SRR2013600",
"Kal_SRR2013601",
"Kal_SRR2013602",
"Kal_SRR2013603",
"Kal_SRR2013604",
"Kal_SRR2013605",
"Kal_SRR2013606",
"Kal_SRR2013607",
"Kal_SRR2013608",
"Kal_SRR2013609",
"Kal_SRR2013610",
"Kal_SRR2013611",
"Kal_SRR2013612",
"Kal_SRR2013613",
"Kal_SRR2013614",
"Kal_SRR2013615",
"Kal_SRR2013616",
"Kal_SRR2013617",
"Kal_SRR2013618",
"Kal_SRR2013619",
"Kal_SRR2013620",
"Kal_SRR2013621",
"Kal_SRR2013622",
"Kal_SRR2013623",
"Kal_SRR2013624",
"Kal_SRR2013625",
"Kal_SRR2013626",
"Kal_SRR2013627",
"Kal_SRR2013628",
"Kal_SRR2013629",
"Kal_SRR2013630",
"Kal_SRR2013631",
"Kal_SRR2013632",
"Kal_SRR2013633",
"Kal_SRR2013634",
"Kal_SRR2013635",
"Kal_SRR2013636",
"Kal_SRR2013637",
"Kal_SRR2013638",
"Kal_SRR2013639",
"Kal_SRR2013640",
"Kal_SRR2013641",
"Kal_SRR2013642",
"Kal_SRR2013643",
"Kal_SRR2013644",
"Kal_SRR2013645",
"Kal_SRR2013646",
"Kal_SRR2013647",
"Kal_SRR2013648",
"Kal_SRR2013649",
"Kal_SRR2013650",
"Kal_SRR2013651",
"Kal_SRR2013652",
"Kal_SRR2013653",
"Kal_SRR2013654",
"Kal_SRR2013655",
"Kal_SRR2013656",
"Kal_SRR2013657",
"Kal_SRR2013658",
"Kal_SRR2013659",
"Kal_SRR2013660",
"Kal_SRR2013661",
"Kal_SRR2013662",
"Kal_SRR2013663",
"Kal_SRR2013664",
"Kal_SRR2013665",
"Kal_SRR2013666",
"Kal_SRR2013667",
"Kal_SRR2013668",
"Kal_SRR2013669",
"Kal_SRR2013670",
"Kal_SRR2013671",
"Kal_SRR2013672",
"Kal_SRR2013673",
"Kal_SRR2013674",
"Kal_SRR2013675",
"Kal_SRR2013676",
"Kal_SRR2013677",
"Kal_SRR2013678",
"Kal_SRR2013679",
"Kal_SRR2013680",
"Kal_SRR2013681",
"Kal_SRR2013682",
"Kal_SRR2013683",
"Kal_SRR2013684",
"Kal_SRR2013685",
"Kal_SRR2013686",
"Kal_SRR2013687",
"Kal_SRR2013688",
"Kal_SRR2013689",
"Kal_SRR2013690",
"Kal_SRR2013691",
"Kal_SRR2013692",
"Kal_SRR2013693",
"Kal_SRR2013694",
"Kal_SRR2013695",
"Kal_SRR2013696",
"Kal_SRR2013697",
"Kal_SRR2013698",
"Kal_SRR2013699",
"Kal_SRR2013700",
"Kal_SRR2013701",
"Kal_SRR2013702",
"Kal_SRR2013703",
"Kal_SRR2013704",
"Kal_SRR2013705",
"Kal_SRR2013706",
"Kal_SRR2013707",
"Kal_SRR2013708",
"Kal_SRR2013709",
"Kal_SRR2013710",
"Kal_SRR2013711",
"Kal_SRR2013712",
"Kal_SRR2013713",
"Kal_SRR2013714",
"Kal_SRR2013715",
"Kal_SRR2013716",
"Kal_SRR2013717",
"Kal_SRR2013718",
"Kal_SRR2013719",
"Kal_SRR2013720",
"Kal_SRR2013721",
"Kal_SRR2013722",
"Kal_SRR2013723",
"Kal_SRR2013724",
"Kal_SRR2013725",
"Kal_SRR2013726",
"Kal_SRR2013727",
"Kal_SRR2013728",
"Kal_SRR2013729",
"Kal_SRR2013730",
"Kal_SRR2013731",
"Kal_SRR2013732",
"Kal_SRR2013733",
"Kal_SRR2013734",
"Kal_SRR2013735",
"Kal_SRR2013736",
"Kal_SRR2013737",
"Kal_SRR2013738",
"Kal_SRR2013739",
"Kal_SRR2013740",
"Kal_SRR2013741",
"Kal_SRR2013742",
"Kal_SRR2013743",
"Kal_SRR2013744",
"Kal_SRR2013745",
"Kal_SRR2013746",
"Kal_SRR2013747",
"Kal_SRR2013748",
"Kal_SRR2013749",
"Kal_SRR2013750",
"Kal_SRR2013751",
"Kal_SRR2013752",
"Kal_SRR2013753",
"Kal_SRR2013754",
"Kal_SRR2013755",
"Kal_SRR2013756",
"Kal_SRR2013757",
"Kal_SRR2013758",
"Kal_SRR2013759",
"Kal_SRR2013760")

kal_dirs <- sapply(samples, function(id) file.path(base_dir, id))

timepoint <- c("PGC_M_4W",
"PGC_M_4W",
"PGC_M_4W",
"PGC_M_4W",
"PGC_M_4W",
"PGC_M_4W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_7W",
"PGC_M_10W",
"PGC_M_10W",
"PGC_M_10W",
"PGC_M_10W",
"PGC_M_10W",
"PGC_M_10W",
"PGC_M_10W",
"PGC_M_10W",
"PGC_M_10W",
"PGC_M_10W",
"PGC_M_10W",
"PGC_M_10W",
"PGC_M_10W",
"PGC_M_10W",
"PGC_M_10W",
"PGC_M_10W",
"PGC_M_10W",
"PGC_M_10W",
"PGC_M_10W",
"PGC_M_10W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_11W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_M_19W",
"PGC_F_4W",
"PGC_F_4W",
"PGC_F_4W",
"PGC_F_4W",
"PGC_F_4W",
"PGC_F_4W",
"PGC_F_4W",
"PGC_F_4W",
"PGC_F_4W",
"PGC_F_4W",
"PGC_F_4W",
"PGC_F_4W",
"PGC_F_8W",
"PGC_F_8W",
"PGC_F_8W",
"PGC_F_8W",
"PGC_F_8W",
"PGC_F_8W",
"PGC_F_8W",
"PGC_F_8W",
"PGC_F_8W",
"PGC_F_8W",
"PGC_F_8W",
"PGC_F_8W",
"PGC_F_8W",
"PGC_F_8W",
"PGC_F_8W",
"PGC_F_8W",
"PGC_F_8W",
"PGC_F_8W",
"PGC_F_10W",
"PGC_F_10W",
"PGC_F_10W",
"PGC_F_10W",
"PGC_F_10W",
"PGC_F_10W",
"PGC_F_10W",
"PGC_F_10W",
"PGC_F_10W",
"PGC_F_10W",
"PGC_F_10W",
"PGC_F_10W",
"PGC_F_10W",
"PGC_F_11W",
"PGC_F_11W",
"PGC_F_11W",
"PGC_F_11W",
"PGC_F_11W",
"PGC_F_11W",
"PGC_F_11W",
"PGC_F_11W",
"PGC_F_11W",
"PGC_F_11W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"PGC_F_17W",
"Soma_M_7W",
"Soma_M_7W",
"Soma_M_7W",
"Soma_M_7W",
"Soma_M_7W",
"Soma_M_7W",
"Soma_M_7W",
"Soma_M_7W",
"Soma_M_7W",
"Soma_M_7W",
"Soma_M_7W",
"Soma_M_7W",
"Soma_M_7W",
"Soma_M_7W",
"Soma_M_7W",
"Soma_M_7W",
"Soma_M_7W",
"Soma_M_7W",
"Soma_M_7W",
"Soma_M_7W",
"Soma_M_7W",
"Soma_M_7W",
"Soma_M_7W",
"Soma_M_7W",
"Soma_M_7W",
"Soma_M_7W",
"Soma_M_10W",
"Soma_M_10W",
"Soma_M_10W",
"Soma_M_10W",
"Soma_M_10W",
"Soma_M_10W",
"Soma_M_10W",
"Soma_M_10W",
"Soma_M_10W",
"Soma_M_10W",
"Soma_M_10W",
"Soma_M_11W",
"Soma_M_11W",
"Soma_M_11W",
"Soma_M_11W",
"Soma_M_11W",
"Soma_M_11W",
"Soma_M_11W",
"Soma_M_11W",
"Soma_M_19W",
"Soma_M_19W",
"Soma_M_19W",
"Soma_F_4W",
"Soma_F_4W",
"Soma_F_4W",
"Soma_F_4W",
"Soma_F_4W",
"Soma_F_4W",
"Soma_F_8W",
"Soma_F_8W",
"Soma_F_8W",
"Soma_F_8W",
"Soma_F_8W",
"Soma_F_8W",
"Soma_F_8W",
"Soma_F_8W",
"Soma_F_8W",
"Soma_F_8W",
"Soma_F_10W",
"Soma_F_10W",
"Soma_F_10W",
"Soma_F_11W",
"Soma_F_11W",
"Soma_F_11W",
"Soma_F_11W",
"Soma_F_11W",
"Soma_F_11W",
"Soma_F_11W",
"Soma_F_11W",
"Soma_F_11W",
"Soma_F_11W",
"Soma_F_17W",
"Soma_F_17W",
"Soma_F_17W",
"Soma_F_17W",
"Soma_F_17W",
"Soma_F_17W",
"Soma_F_17W",
"Soma_F_17W",
"Soma_F_17W") 



s2c <- data.frame(path=kal_dirs, sample=samples, timepoint = timepoint, stringsAsFactors=FALSE)
so2 <- sleuth_prep(s2c,read_bootstrap_tpm = TRUE, extra_bootstrap_summary = TRUE)

saveRDS(so2,file = "SleuthPr.rds")
so3 <- kallisto_table(so2)
write.table(so3, file = "Test2.csv")

#Fit full model
#so2 <- sleuth_fit(so2, ~timepoint, 'full')
#And reduced model
#so2 <- sleuth_fit(so2, ~1, 'reduced')
#so2 <- sleuth_lrt(so2, 'reduced', 'full')
#sleuth_table_gene_2 <- sleuth_results(so2, 'reduced:full', 'lrt', show_all = FALSE)
#write.table(sleuth_table_gene_2, file = "Test1.csv")
